import{u as z,_ as T}from"./GET_REQUESTS.e7dfadbd.js";import{a as D,o as i,f as c,h as t,G as H,r as l,t as a,c as O,H as j,I as q,F as k,C as R,w as S,i as I,v as P,j as B,y as J,D as K,J as Q,K as W}from"./entry.71a57e02.js";import{u as C}from"./cookie.820c3a4b.js";import{u as L}from"./POST_REQUESTS.730cf731.js";const X={props:["modalTitle"]},Y=t("div",{class:"modals-body-bg"},null,-1),Z={class:"modal-programs"},ee={class:"modal-programs-form"};function te(s,o,r,e,m,_){return i(),c("div",null,[Y,t("div",Z,[t("form",ee,[H(s.$slots,"default")])])])}const F=D(X,[["render",te]]),oe={props:["modalName","url"],setup(){const s=L(),o=z(),r=l(!1),e=l(""),m=l([]),_=l(""),b=l([]),v=l(!0),n=l([]),d=l(""),g=l(""),h=f=>{const y={headers:{"Content-type":"application/json",Accept:"application/json",Authorization:"Bearer "+C("token").value}};o.getRequest(`${f}/create`,y,V=>{v.value=!1,b.value=V.data;const x=[];V.data.forEach(u=>{x[u]=""});let{...$}=x;m.value=$})},M=()=>{const f={headers:{"Content-type":"application/json",Accept:"application/json",Authorization:"Bearer "+C("token").value}};o.getRequest("permissions",f,y=>{n.value=y.data})};return{showModal:r,createNewUser:async()=>{g.value&&(m.value.permissions=[],m.value.permissions.push(g.value));const f={method:"POST",body:m.value,headers:{Authorization:"Bearer "+C("token").value}};s.postRequest(`${_.value}/create`,f,y=>{y.success?location.reload():e.value=y.message}),console.log(m.value)},requestError:e,showCreateModal:f=>{h(f),M(),r.value=!r.value,_.value=f},fieldsObj:m,fields:b,arr:n,getPermissions:M,select:d,changeSelect:f=>{g.value=f.id},Loader:T,loading:v}}},ne={class:"fs-3 text-center"},se=["onUpdate:modelValue"],ae=["value"],le={class:"text-danger"};function re(s,o,r,e,m,_){const b=T,v=F;return i(),c("div",null,[t("div",null,[t("button",{class:"main__programs-content-btn modalBtn",onClick:o[0]||(o[0]=n=>e.showCreateModal(r.url))},a(s.$t("create")),1)]),e.showModal?(i(),O(v,{key:0},{default:j(()=>[t("p",ne,a(s.$t("create")),1),e.loading?(i(),O(b,{key:0})):q("",!0),(i(!0),c(k,null,R(e.fields,n=>(i(),c("div",{class:"d-flex flex-column align-items-start gap-2",key:n.id},[n!="permissions"?(i(),c(k,{key:0},[t("label",null,a(s.$t(n)),1),S(t("input",{type:"text","onUpdate:modelValue":d=>e.fieldsObj[n]=d},null,8,se),[[I,e.fieldsObj[n]]])],64)):(i(),c(k,{key:1},[t("label",null,a(s.$t(n)),1),S(t("select",{"onUpdate:modelValue":o[1]||(o[1]=d=>e.select=d),class:"form-select createModal-select",onChange:o[2]||(o[2]=d=>e.changeSelect(e.select))},[(i(!0),c(k,null,R(e.arr,(d,g)=>(i(),c("option",{key:g,value:d},a(d.display_name),9,ae))),128))],544),[[P,e.select]])],64))]))),128)),t("p",le,a(e.requestError),1),t("div",null,[t("button",{class:"btn btn-danger",onClick:o[3]||(o[3]=n=>e.showModal=!e.showModal)},a(s.$t("cancel")),1),t("button",{class:"btn btn-primary",onClick:o[4]||(o[4]=B((...n)=>e.createNewUser&&e.createNewUser(...n),["prevent"]))},a(s.$t("create")),1)])]),_:1})):q("",!0)])}const qe=D(oe,[["render",re]]),de={props:["list","fields","url"],setup(){const s=z(),o=L(),r=l(!1),e=l(!1),m=l(""),_=l(!1),b=l(""),v=l(),n=l(!1),d=l(""),g=l(""),h=l(""),M=l([]),E=l(""),A=l(""),N=()=>{const u={headers:{"Content-type":"application/json",Accept:"application/json",Authorization:"Bearer "+C("token").value}};s.getRequest("roles",u,p=>{M.value=p.data})};return{edit:(u,p,U)=>{N(),n.value=!0,d.value=u,v.value=Object.assign({},p),h.value=U},deleteUser:(u,p)=>{r.value=!r.value,m.value=u,h.value=p},confirmDelete:()=>{const u={method:"POST",headers:{Authorization:"Bearer "+C("token").value}};o.postRequest(`${h.value}/${m.value}/delete`,u,p=>{p.code===403?(b.value=p.message,_.value=!0):location.reload()})},editUser:u=>{const p=[];u.forEach(w=>{p[w]=v.value[w]});let{...U}=p;A.value&&(U.roles=[A.value]);const G={method:"POST",body:U,headers:{Authorization:"Bearer "+C("token").value}};o.postRequest(`${h.value}/${d.value}/update`,G,w=>{w.success?location.reload():g.value=w.message})},confirmModal:r,showModal:e,activeMessage:_,notAccessMessage:b,editModal:n,editCurrentArray:v,editError:g,getRoles:N,arr:M,select:E,changeSelect:u=>{A.value=u.id}}}},ie={class:"dropdown"},ce={class:"btn btn-secondary dropdown-toggle bg-success border-0",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"},ue={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},me={class:"text-center fs-3"},ve={class:"fs-3 text-center"},fe={key:0,class:"d-flex flex-column align-items-start gap-2"},pe=["onUpdate:modelValue"],ge={key:1,class:"d-flex flex-column gap-2 align-items-start"},be={key:0,selected:"",disabled:""},_e=["value"],ye={class:"text-danger"};function ke(s,o,r,e,m,_){const b=W,v=F;return i(),c("div",null,[t("div",null,[t("div",ie,[t("button",ce,a(s.$t("action")),1),t("ul",ue,[t("li",null,[J(b,{to:r.url+"/"+r.list.id,class:"dropdown-item"},{default:j(()=>[K(a(s.$t("show")),1)]),_:1},8,["to"])]),t("li",null,[t("a",{class:"dropdown-item",onClick:o[0]||(o[0]=n=>e.deleteUser(r.list.id,r.url))},a(s.$t("delete")),1)]),t("li",null,[t("a",{class:"dropdown-item",onClick:o[1]||(o[1]=n=>e.edit(r.list.id,r.list,r.url))},a(s.$t("edit")),1)])])])]),e.confirmModal?(i(),O(v,{key:0},{default:j(()=>[t("p",me,a(s.$t("confirmDelete")),1),t("div",null,[t("button",{class:"btn btn-primary",onClick:o[2]||(o[2]=B(n=>e.confirmModal=!e.confirmModal,["prevent"]))},a(s.$t("cancel")),1),t("button",{class:"btn btn-danger",onClick:o[3]||(o[3]=B((...n)=>e.confirmDelete&&e.confirmDelete(...n),["prevent"]))},a(s.$t("perform")),1)]),t("p",{class:Q(["text-danger text-center",{"d-none":!e.activeMessage}])},a(e.notAccessMessage),3)]),_:1})):q("",!0),e.editModal?(i(),O(v,{key:1},{default:j(()=>[t("p",ve,a(s.$t("confirmEdit")),1),(i(!0),c(k,null,R(r.fields,n=>(i(),c(k,{key:n.id},[n!=="role[]"?(i(),c("div",fe,[t("label",null,a(s.$t(n)),1),S(t("input",{type:"text","onUpdate:modelValue":d=>e.editCurrentArray[n]=d},null,8,pe),[[I,e.editCurrentArray[n]]])])):(i(),c("div",ge,[t("label",null,a(s.$t(n)),1),S(t("select",{"onUpdate:modelValue":o[4]||(o[4]=d=>e.select=d),class:"form-select createModal-select",onChange:o[5]||(o[5]=d=>e.changeSelect(e.select))},[e.editCurrentArray.roles[0]?(i(),c("option",be,a(e.editCurrentArray.roles[0].display_name),1)):q("",!0),(i(!0),c(k,null,R(e.arr,(d,g)=>(i(),c("option",{key:g,value:d},a(d.display_name),9,_e))),128))],544),[[P,e.select]])]))],64))),128)),t("p",ye,a(e.editError),1),t("div",null,[t("button",{class:"btn btn-primary",onClick:o[6]||(o[6]=n=>e.editModal=!e.editModal)},a(s.$t("cancel")),1),t("button",{class:"btn btn-danger",onClick:o[7]||(o[7]=B(n=>e.editUser(r.fields),["prevent"]))},a(s.$t("perform")),1)])]),_:1})):q("",!0)])}const Ae=D(de,[["render",ke]]);export{Ae as A,qe as C,F as _};
